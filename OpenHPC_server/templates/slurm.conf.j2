#
# Example slurm.conf file. Please run configurator.html
# (in doc/html) to build a configuration file customized
# for your environment.
#
#
# slurm.conf file generated by configurator.html.
#
# See the slurm.conf man page for more information.

##############################################################
#
#	CLUSTER INFORMATION AND SLURM SETTINGS
#
##############################################################
ClusterName=NegevHPC
ControlMachine=manager-ohpc
SlurmUser=slurm
SlurmctldPort=6817
SlurmdPort=6818
AuthType=auth/munge
#Only remove the # from below if you want to enable slurm HA and set up the StateSaveLocation path to a network share
#StateSaveLocation=/mnt/lbosm-1/install/slurm/ctld 
#SlurmctldHost=SlurmBackup #<- main slurm controller
#SlurmctldHost=manager-ohpc #<- backup-ohpc-ww-controller
StateSaveLocation=/var/spool
SlurmdSpoolDir=/var/spool/slurm/d
SwitchType=switch/none
MpiDefault=none
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmdPidFile=/var/run/slurmd.pid
ProctrackType=proctrack/pgid
MaxArraySize=300000
#JobCredentialPrivateKey=
#JobCredentialPublicCertificate=
#SlurmdUser=root
#BackupAddr=
#ControlAddr=
#PluginDir=
#FirstJobId=
#MaxJobCount=
#PlugStackConfig=
#PropagatePrioProcess=
#PropagateResourceLimits=
#PropagateResourceLimitsExcept=
#Prolog=
#Epilog=
#SrunProlog=
#SrunEpilog=
#TaskProlog=
#TaskEpilog=
#TaskPlugin=
#TrackWCKey=no
#TreeWidth=50
#TmpFS=
#UsePAM=

##################################
#				 #
# 	TIMERS			 #
# 				 #
##################################
SlurmctldTimeout=300
SlurmdTimeout=300
InactiveLimit=0
MinJobAge=300
KillWait=30
Waittime=0

#################################
#				#
#	 SCHEDULING		#
#	 			#
#################################
SchedulerType=sched/backfill
#SchedulerAuth=
SelectType=select/cons_res # instead of select/linear
SelectTypeParameters=CR_Core # from rclsms
FastSchedule=1
PriorityFavorSmall=yes # from rclsms
PriorityType=priority/multifactor # from rclsms
#PriorityDecayHalfLife=14-0
#PriorityUsageResetPeriod=14-0
#PriorityWeightFairshare=100000
PriorityWeightQOS=1000 # changed from PriorityWeightAge
#PriorityWeightPartition=10000
#PriorityWeightJobSize=1000
PriorityMaxAge=3-0

################################
#			       #
# 	LOGGING		       #
# 			       #
################################
SlurmctldDebug=3
SlurmctldLogFile=/var/log/slurmctld.log
SlurmdDebug=3
SlurmdLogFile=/var/log/slurmd.log
JobCompType=jobcomp/filetxt
JobCompLoc=/var/log/slurm/slurmjobs2.log

#########################################
#					#
# 	ACCOUNTING			#
#					#
#########################################
#JobAcctGatherType=jobacct_gather/linux
#JobAcctGatherFrequency=30
AccountingStorageEnforce=associations,limits
#AccountingStorageType=accounting_storage/mysql
AccountingStorageType=accounting_storage/slurmdbd
AccountingStorageHost=manager-ohpc
AccountingStorageBackupHost=manager-ohpc
#AccountingStorageHost=manager-ohpc
AccountingStorageLoc=slurm_acct_db
AccountingStorageUser=slurm
#AccountingStorageType=accounting_storage/filetxt
AccountingStoragePass=/var/run/munge/munge.socket.2
DebugFlags=NO_CONF_HASH # Added from rclsms

#########################################
#					#
# 	COMPUTE NODES			#	
#					#
#########################################
#TaskPlugin=task/affinity
PropagateResourceLimitsExcept=MEMLOCK
Epilog=/etc/slurm/slurm.epilog.clean
NodeName=node0[01,06-14] Sockets=4 CoresPerSocket=8 ThreadsPerCore=1 State=UNKNOWN weight=23 RealMemory=62000 Feature=amd
NodeName=node0[15-19,21-23] Sockets=2 CoresPerSocket=16 ThreadsPerCore=1 State=UNKNOWN weight=7 RealMemory=125000 Feature=HyperThread,hasswell
NodeName=node020 Sockets=2 CoresPerSocket=16 ThreadsPerCore=2 State=UNKNOWN weight=8 RealMemory=125000
#NodeName=xphi1 Sockets=2 CoresPerSocket=10 ThreadsPerCore=1 State=UNKNOWN
NodeName=node0[24-32,33-39,41-46] Sockets=2 CoresPerSocket=16 ThreadsPerCore=1 State=UNKNOWN weight=6 RealMemory=125000 Feature=skylake
#NodeName=node0[51-52] Sockets=2 CoresPerSocket=16 ThreadsPerCore=1 State=UNKNOWN weight=6 RealMemory=188000 Feature=skylake
NodeName=node0[52] Sockets=2 CoresPerSocket=16 ThreadsPerCore=1 State=UNKNOWN weight=6 RealMemory=188000 Feature=skylake
NodeName=gpu001 Sockets=2 CoresPerSocket=32 ThreadsPerCore=1 State=UNKNOWN RealMemory=125000 Feature=gpu
NodeName=gpu002 Sockets=2 CoresPerSocket=32 ThreadsPerCore=1 State=UNKNOWN RealMemory=503000 Feature=a100_gpu
NodeName=nvram00[1-3] Sockets=2 CoresPerSocket=10 ThreadsPerCore=1 State=UNKNOWN Feature=nvram
#NodeName=nvram00[1-2] Sockets=2 CoresPerSocket=10 ThreadsPerCore=1 State=UNKNOWN Feature=nvram

#########################################
#					#
#		PARTITION DATA		#
#					#
#########################################
#					#
#PartitionName=cluster Nodes=node[017-023,025,027-031] Default=YES State=UP
PartitionName=cluster Nodes=node[016-023,025-029] Default=YES State=UP
PartitionName=gpu Nodes=gpu001 Default=NO State=UP
PartitionName=gpua100 Nodes=gpu002 Default=NO State=UP
#PartitionName=xphi Nodes=xphi1 Default=NO State=UP
PartitionName=snrc Nodes=node[006-014] State=UP
#PartitionName=pazy Nodes=node016 Default=NO State=UP
PartitionName=nvram Nodes=nvram00[1-3] Default=NO State=UP
#PartitionName=private Nodes=node[030-034] Default=NO State=UP
#PartitionName=private Nodes=node[030-033] Default=NO State=UP
#PartitionName=private Nodes=node[026-028,030-031,033-036],nvram001 Default=NO State=UP
PartitionName=backus Nodes=node[036,041-042] Default=NO State=UP
PartitionName=technion Nodes=node[043-046] Default=NO State=UP
#PartitionName=mixedp Nodes=node[001,006-031,033-039,042-046,051-052] Default=NO State=UP
PartitionName=mixedp Nodes=node[006-039,041,052] Default=NO State=UP
ReturnToService=2
#HealthCheckProgram=/usr/sbin/nhc
#HealthCheckInterval=300
